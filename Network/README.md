# Network

아래 내용은 https://net123.tistory.com/384?category=605873 를 통해 공부하고 정리한 내용입니다.

## 프로토콜
* 데이터 전송 시 필요한 규칙 및 약속을 미리 정의한 도구
* 네트워크가 구성되기 이전에 미리 정의되거나 관리자에 의해 선택되어야 한다.

그럼 프로토콜 어떻게 사용할까?

## 인캡슐레이션
데이터 보내기 위해 포장하는 과정

* HTTP 보내기 위해 TCP라는 프로토콜 사용
* 위에 것을 보내려면 IP 사용
* 위에 것 보내려면 Ethernet 사용

	Ethernet | IP | TCP | HTTP
    
* 헤더 : Ethernet, IP, TCP
	이런식으로 전송을 위해 붙는 프로토콜을 '헤더'라고 한다. 헤더 정보 속 주소를 보고 도착지로 움직인다.
    
* HTTP
    * TCP 헤더 20byte
    * IP 헤더 20byte
    * Ethernet 헤더 14byte

* DNS
    * UDP
    * IP
    * Ethernet

## 네트워크 유형

### LAN(Local Area Network)
* 전송 장비
	* 허브
	* 스위치
	* 케이블(랜선)
	* 무선 공유기

* 데이터 전송 프로토콜 
	* Ethernet (안에서 이동하게 쓰는 것)
		출발지 MAC주소, 도착지 MAC주소, type(내부 들어있는 데이터 타입)

### WAN(Wide Area Network)
연결되는 거리가 멀다. LAN과 LAN을 연결한다.
ISP업체를 통해 연결. 인터넷과 네트워크망을 임대해주는 업체. WAN은 일반적으로 ISP를 통해서 연결된다. 대표적인 ISP로는 KT, SK, LG가 있다.

* 사용 프로토콜
	* HDLC (기본값)
	* frame-relay
	* PPP
	* 요즘에는 Ethernet 사용, 구분이 없음.
		* FastEthernet 100M
		* GigabitEthernet 1000M
		* 10GigabitEthernet 10000M

* 관리는 ISP업체가 담당한다. 


### 인터넷
* 전세계적으로 연결된 네트워크 망 서비스
* TCP/IP가 반드시 필요

### Intranet
* 기업 내부용으로 사용하는 네트워크 서비스
* 회사 게시판, 공지사항, 자료 공유 ...

## 데이터 요청 관계

### 서버(Server)
클라이언트로부터 요청된 정보를 수신

### 클라이언트(Client)
서버에게 데이터를 요청 실시

### 데이터 전송 방식
* 대역폭 10M 라면?
* 가장 많이 사용하는 것은 유니테스트

#### 유니테스트
* 일대일 데이터 전송
* 대역폭을 늘려야만 고객 수용 가능
* 1M 데이터 전송하려면 100명에게 동시 전송 불가능
* 예 : 생방송 중 나는 처음부터 보려고 할 때

#### 브로드케스트
* 일대다 데이터 전송(전체)
* 서버에서는 한개만 전송, 스위치에서 복제 후 전송
* 대역폭 증설 필요가 없음
* 내부 네트워크에서만 주로 사용
* LAN 네트워크 성능이 저하
* 라우터가 받으면 다른 네트워크로는 내보내지 않음

#### 멀티케스트
* 일대다 데이터 전송(그룹)
* 특정 그룹한테만 데이터 전송
* 예: 유료 결제 고객에게만 데이터를 전송
	* VOD서비스: 결제한 고객만 전송

## OSI 7계층

## TCP와 UDP
[참고 : TCP와 UDP 차이점](https://mangkyu.tistory.com/15) 

### 공통점
* 네트워크 계층 중 전송 계층에서 사용하는 프로토콜

### 차이점
#### TCP 
* 흐름제어 및 혼잡제어 제공
* 높은 신뢰성
* UDP보다 낮은 속도
* **3-way handshaking** 과정을 통해 연결 

#### UDP 
* 데이터그램 단위로 처리하는 프로토콜
* 비연결형 서비스
* 낮은 신뢰성
* TCP보다 빠른 속도
* 신뢰성보다 연속성이 중요한 서비스(ex.스트리밍 서비스)에 많이 이용

## TCP를 이용한 통신 과정
### 3-way handshaking
TCP를 사용한 데이터 송수신 간의 정확한 전송을 보장하기 위한 **세션 수립 과정**
##### 1. 클라이언트가 서버에게 요청 세그먼트 전송
송신자가 최초로 데이터를 전송할 때 Sequence Number를 임의의 랜덤 숫자로 지정
SYN 플래그 비트를 1로 설정해서 전송

    Flag : SYN
    PORT : Client(CLOSED),Server(Listen)
##### 2. 서버가 클라이언트의 요청을 받아들이는 세그먼트 전송, 클라이언트로 향하는 트래픽에 대한 초기화 정보를 포함하는 세그먼트를 전송
수신자는 Acknowledgement Number 필드를 Sequence Number+1로 지정
SYN과 ACK 플래그 비트 1로 설정해서 전송

    Flag : SYN + ACK
    PORT : Client(CLOSED),Server(SYN_RCV)
##### 3. 클라이언트는 이를 응답하는 세그먼트 전송
마지막 접속 요청 프로세스 A가 수락 확인을 보내 연결 맺음
전송 데이터가 있을 경우, 이때 전송

	PORT : Client(ESTABLISHED), Server(SYN_RCV)
    Flag : ACK
	PORT : Client(ESTABLISHED), Server(ESTABLISHED)

### 4-way handshaking
TCP를 사용한 데이터 송수신 간의 정확한 전송을 보장하기 위한 **세션 종료 과정**
##### 1. 클라이언트는 연결 종료를 알리는 세그먼트 전송
	Flag : FIN, ACK
    FIN:1 A:0
##### 2. 서버는 클라이언트의 요구를 확인하는 세그먼트 전송
    Flag : ACK
    ACK:1
서버는 클라이언트로 데이터를 계속 전송
한 방향의 연결은 종료되나, 다른 방향 연결은 유지

##### 3. 서버가 자신의 데이터 전송 완료하면, 서버가 연결 해지 세그먼트 전송
	Flag:FIN,ACK
    FIN:1, ACK:1
##### 4. 클라이언트는 서버의 요청에 확인 응답
	Flag:ACK
    ACK:1
    
## HTTP 와 HTTPS
### HTTP 프로토콜이란?
웹 상에서 클라이언트와 서버간의 요청/응답으로 정보를 주고 받을 수 있는 프로토콜
* TCP와 UDP를 사용
* 80번 포트를 사용
* 비연결성(Connectionless) : 클라이언트의 요청 후, 서버가 클라이언트로 응답을 보내면 바로 연결이 끊긴다.
* 무상태성(Stateless) : 연결을 끊는 순간 통신이 끝나며, 상태 정보를 유지하지 않는다.

### HTTPS 프로토콜이란?
HTTP의 보안이 강회된 버전의 프로토콜
* HTTPS의 기본 TCP/IP 포트로 443번 포트를 사용
* 소켓 통신에서 일반 텍스트를 사용하며, 웹 상에서 정보를 암호화하는 **SSL** 이나 **TLS** 프로토콜을 통해 세션 데이터를 암호화한다.

#### HTTPS의 원리
공개키 알고리즘 방식
* 공개키 : 모두에게 공개하는 키, 공개키 저장소에 등록
* 개인키 : 개인에게만 공개. 클라이언트-서버 구조에서 서버가 가지고 있는 비공개키


	1. 사용자의 데이터를 공개키로 암호화
	2. 서버로 전송
	3. 서버의 개인키를 통해 복호화하여 요청 처리

#### HTTPS의 장단점
* 장점 : 안전하다
* 단점
	1. 암호화 과정이 웹서버에 부하를 준다.
	2. 설치, 인증서 유지에 추가 비용
	3. 느리다
	4. 연결 끊긴 경우 재인증 시간 소요

## Socket통신과 Http통신
[참고 : Socket통신과 Http통신 차이점](https://mangkyu.tistory.com/15)

### HTTP통신
Client의 요청(Request)이 있을 때만 서버가 응답(Response)하여 해당 정보를 전송하고 곧바로 연결을 종료하는 방식
#### 특징
* 단방향 통신 : Client가 요청을 보낸 경우만 Server가 응답
* Server의 응답 받은 후 연결 종료
* 필요한 경우에만 Server로 요청 보내는 상황

### Socket통신
Server와 Client가 특정 Port를 통해 실시간으로 양방향 통신하는 방식
#### 특징
* 양방향 통신 : Server와 Client가 계속 연결을 유지
* 실시간으로 데이터를 주고받는 상황이 필요한 경우 사용
* 실시간 Streaming, 온라인 게임 등에 자주 사용
